<footer style="background-color: var(--utec-dark); color: var(--white); padding: 30px 0; text-align: center;<%= typeof marginTop !== 'undefined' ? ' margin-top: ' + marginTop + ';' : '' %>" role="contentinfo">
    <div class="container">
        <p>&copy; <span class="current-year"></span> LTI.UY - Plataforma no oficial para estudiantes de LTI</p>
        <div style="margin-top: 15px;">
            <a href="https://linkedin.com/in/brunomartinezuy" target="_blank" style="color: #74b9ff; text-decoration: none; margin: 0 15px;">LinkedIn</a>
            <a href="https://surlink.cc" target="_blank" style="color: #74b9ff; text-decoration: none; margin: 0 15px;">SurLink.cc</a>
            <a href="https://dokta.cc" target="_blank" style="color: #74b9ff; text-decoration: none; margin: 0 15px;">Dokta.cc</a>
            <a href="https://micope.org" target="_blank" style="color: #74b9ff; text-decoration: none; margin: 0 15px;">Micope.org</a>
        </div>
        <% if (typeof showTerms !== 'undefined' && showTerms) { %>
        <p style="margin-top: 10px; font-size: 0.9rem;">
            <a href="/terms" style="color: var(--utec-secondary); text-decoration: none;">Términos y Condiciones</a>
        </p>
        <% } %>
    </div>
</footer>

<!-- AI Assistant Widget -->
<% if (typeof session !== 'undefined' && session.authenticated) { %>
<div id="assistant-overlay"></div>

<div id="assistant-widget">
    <button id="assistant-toggle" title="Asistente de IA">🤖</button>
    <div id="assistant-popup">
        <div id="assistant-header">
            <h3>
                🤖 Asistente LTI.UY
            </h3>
            <div id="assistant-header-buttons">
                <button id="assistant-history-btn" title="Historial de chat">📜</button>
                <button id="assistant-new-chat" title="Nueva conversación">➕</button>
                <button id="assistant-close" title="Cerrar">×</button>
            </div>
        </div>
        <div id="assistant-messages">
            <div class="assistant-empty-state">
                <div class="assistant-empty-icon">💬</div>
                <h4>¡Hola! Soy tu asistente de LTI.UY</h4>
                <p>Pregúntame sobre tu progreso académico, materias, créditos, planes de carrera o cualquier duda sobre UTEC.</p>
            </div>
        </div>
        <form id="assistant-form">
            <input type="text" id="assistant-input" placeholder="Escribe tu pregunta aquí..." autocomplete="off" />
            <button type="submit" id="assistant-send">Enviar</button>
        </form>

        <!-- AI Disclaimer -->
        <div id="assistant-disclaimer">
            <span>⚠️ Los datos generados por la IA pueden tener errores, siempre corroborarlos.</span>
        </div>

        <!-- History Panel -->
        <div id="assistant-history-panel">
            <div id="assistant-history-header">
                <h3>
                    📜 Historial de Chat
                </h3>
                <div>
                    <button id="assistant-clear-history" title="Limpiar historial">🗑️</button>
                    <button id="assistant-history-close" title="Cerrar historial">×</button>
                </div>
            </div>
            <div id="assistant-history-list">
                <div class="history-empty">
                    <div class="history-empty-icon">💬</div>
                    <p>No hay conversaciones anteriores</p>
                </div>
            </div>
        </div>
    </div>
</div>
<% } %>

<script>
    // Set dynamic copyright year for all footer instances
    document.addEventListener('DOMContentLoaded', function() {
        const yearElements = document.querySelectorAll('.current-year');
        yearElements.forEach(element => {
            element.textContent = new Date().getFullYear();
        });
    });
</script>